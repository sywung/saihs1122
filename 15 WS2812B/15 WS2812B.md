## 臺北市立松山工農112學年度第二學期-感測器實習學習單 

<center><font size=6>【WS2812B LED串列控制】</font></center>



<div style="text-align: right">班級：______________ 座號：________姓名：________________</div>

#### 一、WS2812B

WS2812 RGB LED是具有內建驅動晶片功能的LED, 常見用5050 LED封裝加入驅動晶片, 驅動方式採串列進出, 因此可獨立控制串接LEDs的每一顆LED.

每個一R/G/B顏色可獨立控制,且每一個顏色可調整0~255階調,因此每一個顏色需用到8bit控制,每一顆LED需用到24bit控制.

<center>
<img src="assets/1.png" alt="image" width="auto" height="180">  <img src="assets/2.png" alt="image" width="auto" height="120">  <img src="assets/3.png" alt="image" width="auto" height="220">
</center>
常見的模組型式有下列這幾種。要注意連接的方式，一般而言，為了方便擴充，通常會有輸入端及輸出端2個端子。將輸入端接到前一級的輸出端就可以達到串接擴充的目地。

<center>
<img src="assets/4.jpeg" alt="image" width="auto" height="180">  <img src="assets/5.jpg" alt="image" width="auto" height="180">  <img src="assets/6.jpg" alt="image" width="auto" height="180">
</center>
 

#### 二、函式庫安裝

FastLED 是一款功能强大，簡單易用的 LED光條 Arduino第三方库。 目前FastLED是公认的Arduino开发者应用最为广泛的LED控制库之一。由於目前的版本一直更新中，可能會有一些版本出現問題，解決方法就是使用較舊的版本。

#### 四、程式說明

1. 讓光環呈現紅色

```c {.line-numbers}
#include "FastLED.h"            // 此示例程序需要使用FastLED库
 
#define NUM_LEDS 16             // LED灯珠数量
#define LED_DT 9                // Arduino输出控制信号引脚
#define LED_TYPE WS2812B         // LED灯带型号
#define COLOR_ORDER GRB         // RGB灯珠中红色、绿色、蓝色LED的排列顺序
 
uint8_t max_bright = 128;       // LED亮度控制变量，可使用数值为 0 ～ 255， 数值越大则光带亮度越高
 
CRGB leds[NUM_LEDS];            // 建立光带leds
 
void setup() { 
  LEDS.addLeds<LED_TYPE, LED_DT, COLOR_ORDER>(leds, NUM_LEDS);  // 初始化光带
  
  FastLED.setBrightness(max_bright);                            // 设置光带亮度
  
  fill_solid(leds, NUM_LEDS, CRGB::Red);  // 設定光帶顯示紅色
  FastLED.show();                         // 讓光帶輸出設定的紅色
}
 
void loop () {}

```

2. 将LED光環设置为渐变彩虹色
```c {.line-numbers}
#include "FastLED.h"            // 此示例程序需要使用FastLED库
 
#define NUM_LEDS 16             // LED灯珠数量
#define LED_DT 9                // Arduino输出控制信号引脚
#define LED_TYPE WS2812B         // LED灯带型号
#define COLOR_ORDER GRB         // RGB灯珠中红色、绿色、蓝色LED的排列顺序
 
uint8_t max_bright = 128;       // LED亮度控制变量，可使用数值为 0 ～ 255， 数值越大则光带亮度越高
 
CRGB leds[NUM_LEDS];            // 建立光带leds
 
uint8_t beginHue = 0;
uint8_t deltaHue = 1;
 
void setup() { 
  LEDS.addLeds<LED_TYPE, LED_DT, COLOR_ORDER>(leds, NUM_LEDS);  // 初始化光带
  
  FastLED.setBrightness(max_bright);                            // 设置光带亮度
}
 
void loop () {       
  // fill_rainbow演示
  fill_rainbow(leds, NUM_LEDS, beginHue, deltaHue); 
  FastLED.show();
  delay(25); 
} 

```

   

#### 五、自我練習

1. 完成單一LED繞圈程式，每當完成一圈就換一種顏色亮度。
2. 利用3個按鈕開關模擬左/右轉、剎車開關。當轉向端按下時，相對應方向的7個LED每0.5秒以黃色交互明滅。紅色按下時，全部的LED亮紅色，放開時熄滅。剎車開關有最高的優先權。

